<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/pageCurtain.css" rel="stylesheet">
    <link href="css/typing.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <title>브리핑</title>
</head>
<body>
    <div id="loader">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
    <div> 브리핑 .. </div>
    <div class="typing-txt"> 
        <ul>
            <li id="dawnTxt"></li>
            <li id="amTxt"> </l>
            <li id="pmTxt"></li>
        </ul>
    </div> 

    <div class="typing">
        <ul>
            <li></li>
            <li></li>
            <li></li>
        </ul>
    </div> 
    
    <script>      
        const text1 = document.getElementById("dawnTxt");
        const text2 = document.getElementById("amTxt");
        const text3 = document.getElementById("pmTxt");

        const changeValue = [
            { id: "bible", text: "야호~! 오늘은 기다리고 기다리던 여름성경학교 날이다!"},
            { id: "tumbler", text: "텀블러만 사용해도 일회용 컵들을 많이 줄일 수 있어!" },
            { id: "foodwaste", text: "오늘은 음식물 쓰레기를 버리는 날, 음식물 쓰레기를 정리해서 버려볼까?" },
            { id: "bicycle", text: "오늘은 자전거 타기 딱~좋은 날씨구만!" },
            { id: "aircon", text: "나는야 에어컨 온도 지킴이! 여름철 실내 적정 온도는 26도야. 26도만 되도 충분히 시원하지" },
            { id: "soap", text: "환경을 생각하는 청지기라면 천연비누 정도는 사용해야지~" },
            { id: "savewater", text: "물을 절약하는 것도 환경보호에 굉장한 효과가 있어!" },
            { id: "worm", text: "지렁이는 흙속 유기물을 먹고 배출하면서 토양을 비옥하게 만들어요. 그래서 식물이 더 잘 자라는 토양을 만들어주니까 지렁이를 준비해서 방생해볼까요?" },
            { id: "recycle", text: "분리수거만 잘해도 토양오염을 줄일 수 있어요!" },
            { id: "tree", text: "우리에게 깨끗한 공기를 주는 나무를 심어요." },
            { id: "air", text: "우리 동네 대기오염도를 조사해봅시다! 대기오염도를 알아야 경각심을 갖고 대책을 마련할 수 있어요!" },
            { id: "sea", text: "바닷가 주변에 플라스틱, 비닐 쓰레기를 주워주세요. 이런 쓰레기들이 바다로 가면 바다에 살고 있는 생물들이 위험해진답니다." },
            { id: "river", text: "쓰레기가 하천으로 가면 물이 오염돼요. 하천 주변에 있는 쓰레기를 줍는 봉사활동을 합니다." },
            { id: "campaign", text: "오늘은 환경캠페인이 열리는 날! 청지기라면 환경캠페인엔 무조건 참여해야겠죠?!" },
            { id: "camp", text: "오랜만에 자연 속에서 쉼을 누리며 캠핑을 즐겨볼까? 바비큐도 먹고 불멍도 해야지~" },
            { id: "plane", text: "빨리 여행지로 가고 싶은데.. 역시 빠르고 편한 비행기를 타고 가야겠어." },
            { id: "beach", text: "여름엔 역시 시원한 해수욕장이 최고야! 튜브타고 신나게 놀아야지~" },
            { id: "rest", text: "환경을 지키는 청지기에게도 쉼은 필요해. 푹 쉬고 에너지를 충전해서 다시 청지기로서 하나님이 주신 아름다운 세상을 지키러 가야지~!" }
        ]

        function setText(findThis, tag) {
            for(let value of changeValue){
                if(value['id'] == findThis){
                    tag.innerText = value['text'] + '\n';
                    break;
                }
            }
        }

        const temp = location.href.split("?"); 
        const data= temp[1].split(":"); 
        const dawn = data[0]; 
            
        console.log(data);

        if(data.length == 2){
            const am = data[1];
            setText(am, text2);
        }
        if(data.length == 3){
            const pm = data[2];
            setText(pm, text3);            
        } 
        setText(dawn, text1);

        function startTyping(){     // 출처: https://gahyun-web-diary.tistory.com/2
            var typingBool = false; 
            var typingIdx=0; 
            var liIndex = 0;
            var liLength = $(".typing-txt>ul>li").length;

            // 타이핑될 텍스트를 가져온다 
            var typingTxt = $(".typing-txt>ul>li").eq(liIndex).text(); 
            typingTxt=typingTxt.split(""); // 한글자씩 자른다. 
            
            if(typingBool==false){ // 타이핑이 진행되지 않았다면 
                typingBool=true; 
                var tyInt = setInterval(typing,100); // 반복동작 
            }
                
            function typing(){ 
                $(".typing ul li").removeClass("on");
                $(".typing ul li").eq(liIndex).addClass("on");
                if(typingIdx<typingTxt.length){ // 타이핑될 텍스트 길이만큼 반복 
                    $(".typing ul li").eq(liIndex).append(typingTxt[typingIdx]); // 한글자씩 이어준다. eq()는 인덱스 번호에 해당하는 요소를 리턴
                    typingIdx++; 
                } else{ 
                    if(liIndex<liLength-1){
                        //다음 문장으로 가기위해 인덱스를 1증가
                        liIndex++; 
                        //다음 문장을 타이핑하기위한 셋팅
                        typingIdx = 0;
                        typingBool = false; 
                        typingTxt = $(".typing-txt>ul>li").eq(liIndex).text(); 
                        
                        //다음 문장 타이핑전 1초 쉰다
                        clearInterval(tyInt);
                        //타이핑종료
                        
                        setTimeout(function(){
                            //1초후에 다시 타이핑 반복 시작
                            tyInt = setInterval(typing,100);
                        },1000);
                    } else if(liIndex == liLength-1){
                        //마지막 문장까지 써지면 반복종료
                        clearInterval(tyInt);
                    }
                } 
            }
        }

        setTimeout(() => {
            startTyping();
        }, 3000);


    </script>
    <script type="text/javascript" src="js/pageCurtain.js"></script>
</body>
</html>